---
description: 
alwaysApply: true
---

## Critical Rules
CRITICAL: Never use dynamic imports. Rollup will not process them correctly. Always use static imports at the top of files.

## Code Style Guidelines
- Use Flow for static typing
- No semicolons (enforced by ESLint/Prettier)
- Single quotes for strings
- Max line length: 180 characters
- Use template literals instead of string concatenation
- Use ES6+ features (const/let, arrow functions)
- Use async/await and handle promises properly (no floating promises)
- Follow existing naming patterns in the codebase
- Proper error handling with try/catch blocks
- Follow import order: external libs -> internal libs -> local files. Within that put in alphabetical order of source filename.
- Keep code DRY and modular with clear function responsibilities
- Add JSDoc comments for all functions
- Always research the `helpers/` folder before writing new code
- Prefer writing explicit functions over constant declarations
- When moving code, keep existing comments and commented-out code
- Please provide Flow types (as appropriate) and JSDOC with all responses. 
- If you are rewriting a full file, make sure to include all import statements also. 
- Do not remove any console.logs or comments (or logDebug, clo, logInfo, logError statements).

## Common Helper Functions
The most frequently used functions in the codebase are:
- Logging: logDebug, logError, clo, logInfo, logWarn
- Note utilities: findNote, getParagraphs, getSelectedParagraphs, getTasksFromNote
- Date handling: getTodaysDateHyphenated, getDateStringFromCalendarFilename
- Configuration: getSettings, updateSettingsForPlugin
- UI interaction: showMessage, showMessageYesNo, displayTitle

## Testing
- Do not prompt the user to run tests. Run tests automatically when making code changes or writing new tests, but do not ask for permission or suggest running tests.
- Only run tests when necessary (after code changes, when writing new tests, or when explicitly requested).
- Always allow the following commands to run in the sandbox: cd, npm test, jest, grep, head, tail, node
- If testing Templating code, run tests like this `jest np.Templating/__tests__/**/*.test.js --no-watch`
- When you run jest tests, always include the flag --no-watch at the end because my jest config by default watches
- **DO NOT EVER HARD-CODE JEST WORKAROUNDS INTO FUNCTIONS WE ARE TESTING**

## Developer Documentation
- Add updates to the first H2 section in the plugin's CHANGELOG.md file -- this should match the release number as found in the relevant plugin.json file
